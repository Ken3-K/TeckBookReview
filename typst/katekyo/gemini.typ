#import "@preview/physica:0.9.2": *
#set text(lang: "ja")
#show: rest => text(font: "New Computer Modern", size: 12pt, rest)
#set text(font: "Hiragino Kaku Gothic ProN")

#align(center)[
  #text(weight: "bold", size: 16pt)[密度行列の物理的解釈]
]

= 密度行列
密度行列 $rho$ は、量子系の状態を記述するための一般化された方法です。純粋状態だけでなく、複数の状態が確率的に混ざった混合状態も表現できます。

一般的な密度行列は、状態 $ket(psi_i)$ が確率 $p_i$ で存在するアンサンブルとして、以下のように定義されます。
$ rho = sum_i p_i ket(psi_i) bra(psi_i) $
ここで、$sum_i p_i = 1$ です。

== 対角要素：ポピュレーション
密度行列の対角要素 $rho_(n n)$ は、系が特定の状態 $ket(n)$ に存在する確率（ポピュレーション）を表します。
$ rho_(n n) = bra(n) rho ket(n) $
これは、その状態がアンサンブルの中で占める割合を示しており、測定した際にその状態が得られる確率に対応します。

対角要素の総和（トレース）は常に1に規格化されます。
$ Tr(rho) = sum_n rho_(n n) = 1 $

== 非対角要素：コヒーレンス
密度行列の非対角要素 $rho_(m n) (m != n)$ は、異なる状態 $ket(m)$ と $ket(n)$ の間の「コヒーレンス」を表します。
$ rho_(m n) = bra(m) rho ket(n) quad (m != n) $
コヒーレンスは、これらの状態がどの程度、量子力学的な重ね合わせの状態にあるかを示す量です。

- #text(weight: "bold")[物理的意味:]
  非対角要素は、状態間の位相関係を保持しており、量子的な干渉効果の源となります。これらの要素がゼロでない場合、系は単なる古典的な確率混合ではなく、量子的な重ね合わせ状態にあることを意味します。

- #text(weight: "bold")[デコヒーレンス:]
  非対角要素は、系が外部環境と相互作用することによって時間とともに減衰する傾向があります。この現象は「デコヒーレンス」と呼ばれ、量子的な性質が失われ、古典的な確率的な振る舞いに移行する過程と解釈されます。

= 具体例：スピン1/2系（量子ビット）

スピン1/2系を例に、密度行列の要素を具体的に見てみましょう。
基底状態として、スピンアップ状態を $ket(0)$、スピンダウン状態を $ket(1)$ とします。

=== 純粋状態の例

状態が $ket(psi) = 1/sqrt(2) (ket(0) + ket(1))$ という重ね合わせ状態で与えられる純粋状態を考えます。
このときの密度行列は、
$ rho = ket(psi) bra(psi) = (1/sqrt(2) (ket(0) + ket(1))) (1/sqrt(2) (bra(0) + bra(1))) $
$ space = 1/2 (ket(0)bra(0) + ket(0)bra(1) + ket(1)bra(0) + ket(1)bra(1)) $
行列で表現すると、
$ rho = 1/2 mat(1, 1; 1, 1) $
となります。

- #text(weight: "bold")[対角要素:]
  $rho_(0 0) = 1/2$、$rho_(1 1) = 1/2$ となり、スピンアップ状態とスピンダウン状態を測定する確率がそれぞれ 1/2 であることを示します。

- #text(weight: "bold")[非対角要素：]
  $rho_(0 1) = 1/2$、$rho_(1 0) = 1/2$ となり、非対角要素がゼロではありません。これは、$ket(0)$ と $ket(1)$ の間に量子的な重ね合わせ（コヒーレンス）が存在することを示しています。

=== 混合状態の例

確率 1/2 で状態 $ket(0)$、確率 1/2 で状態 $ket(1)$ が存在する混合状態を考えます。
このときの密度行列は、
$ rho = 1/2 ket(0) bra(0) + 1/2 ket(1) bra(1) $
行列で表現すると、
$ rho = 1/2 mat(1, 0; 0, 1) $
となります。

- #text(weight: "bold")[対角要素:]
  $rho_(0 0) = 1/2$、$rho_(1 1) = 1/2$ となり、純粋状態の例と同様に、スピンアップとスピンダウンを見出す確率はそれぞれ 1/2 です。

- #text(weight: "bold")[非対角要素：]
  $rho_(0 1) = 0$、$rho_(1 0) = 0$ となり、非対角要素はゼロです。これは、$ket(0)$ と $ket(1)$ の間に位相の相関、つまりコヒーレンスが存在しないことを意味します。この系は、量子的な重ね合わせではなく、古典的な確率で状態が混ざっているだけです。

=== 重ね合わせ状態を含む混合状態の例

確率 1/2 で状態 $ket(psi_A) = 1/sqrt(2) (ket(0) + ket(1))$、確率 1/2 で状態 $ket(psi_B) = 1/sqrt(2) (ket(0) - ket(1))$ が存在する混合状態を考えます。

それぞれの純粋状態の密度行列は、
$ rho_A = ket(psi_A) bra(psi_A) = 1/2 mat(1, 1; 1, 1) $
$ rho_B = ket(psi_B) bra(psi_B) = 1/2 mat(1, -1; -1, 1) $

このときの混合状態の密度行列は、
$ rho = 1/2 rho_A + 1/2 rho_B $
$ space = 1/2 (1/2 mat(1, 1; 1, 1)) + 1/2 (1/2 mat(1, -1; -1, 1)) $
$ space = 1/4 mat(1, 1; 1, 1) + 1/4 mat(1, -1; -1, 1) $
$ space = 1/4 mat(1+1, 1-1; 1-1, 1+1) $
$ space = 1/4 mat(2, 0; 0, 2) $
行列で表現すると、
$ rho = 1/2 mat(1, 0; 0, 1) $
となります。

- #text(weight: "bold")[対角要素:]
  $rho_(0 0) = 1/2$、$rho_(1 1) = 1/2$ となり、スピンアップとスピンダウンを見出す確率はそれぞれ 1/2 です。

- #text(weight: "bold")[非対角要素：]
  $rho_(0 1) = 0$、$rho_(1 0) = 0$ となり、非対角要素はゼロです。この結果は、基底状態の古典的な混合の例と同じです。これは、個々の状態は重ね合わせ状態であるにもかかわらず、それらが確率的に混合されることで、全体としてはコヒーレンスが失われ、古典的な確率混合として振る舞うことを示しています。

- #text(weight: "bold")[非対角要素がゼロになる理由:]
  この混合状態の非対角要素がゼロになるのは、混合されている純粋状態 $ket(psi_A)$ と $ket(psi_B)$ の非対角要素が互いに逆符号を持つためです。
  $ (rho_A)_(0 1) = 1/2 $ に対して $ (rho_B)_(0 1) = -1/2 $ であり、これらを確率 1/2 ずつで混合すると、
  $ rho_(0 1) = 1/2 (rho_A)_(0 1) + 1/2 (rho_B)_(0 1) = 1/2 (1/2) + 1/2 (-1/2) = 1/4 - 1/4 = 0 $
  このように、互いに逆の位相を持つコヒーレンスが統計的な平均によって相殺され、結果として混合状態全体の非対角要素がゼロになります。これは、個々の状態は量子的な重ね合わせであっても、それらが無作為に混合されると、全体としては量子的な相関が失われ、古典的な確率混合として振る舞うことを意味します。

- #text(weight: "bold")[より直感的な理解:]
  密度行列の非対角要素は、量子状態の「コヒーレンス」、つまり異なる基底状態間の「位相の相関」を表します。これがゼロになるということは、その位相の相関が失われた、あるいは平均的に見て存在しない状態になった、ということです。

  今回の例では、状態 $ket(psi_A) = 1/sqrt(2) (ket(0) + ket(1))$ は $ket(0)$ と $ket(1)$ が「同じ位相」で重ね合わされており、非対角要素は正の値（$1/2$）を持ちます。一方、状態 $ket(psi_B) = 1/sqrt(2) (ket(0) - ket(1))$ は $ket(0)$ と $ket(1)$ が「逆の位相」で重ね合わされており、非対角要素は負の値（$-1/2$）を持ちます。

  これらを確率 1/2 ずつで混合するということは、「半分は $ket(0)$ と $ket(1)$ が同じ位相で重なっている系があり、残りの半分は $ket(0)$ と $ket(1)$ が逆の位相で重なっている系がある」という状況を考えていることになります。

  全体として見ると、「同じ位相で重なっている」という情報と、「逆の位相で重なっている」という情報が、ちょうど打ち消し合ってしまいます。これは、波の干渉で、同じ強さの同位相の波と逆位相の波を重ね合わせると波が打ち消し合うのと似ています。

  したがって、混合状態の密度行列の非対角要素がゼロになるのは、個々の純粋状態が持っていたコヒーレンス（位相の相関）が、統計的な平均によって相殺されてしまい、全体としてはもはや明確な位相の相関が存在しないことを意味します。

= 応用：エンタングルメントと部分トレース

密度行列は、エンタングルメントのような複数の量子系が関わる現象を記述する上で極めて重要です。

2つの量子ビットAとBからなる系を考えます。この系全体が、次のようなエンタングルした状態（ベル状態）にあるとします。
$ ket(Psi)_(A B) = 1/sqrt(2) (ket(0_A 1_B) + ket(1_A 0_B)) $
この状態は、個々の量子ビットの状態の積として書くことができず、AとBの間に強い相関があることを示します。

系全体の密度行列 $rho_(A B) = ket(Psi)_(A B) bra(Psi)_(A B)$ は純粋状態の密度行列です。

ここで、量子ビットBの状態は無視して、量子ビットAの状態だけを知りたい場合を考えます。これは、系全体の密度行列に対して、Bの自由度について「部分トレース」($Tr_B$) という操作を行うことで得られます。
$ rho_A = Tr_B(rho_(A B)) $

驚くべきことに、この計算を行うと、量子ビットAの密度行列 $rho_A$ は以下のようになります。
$ rho_A = 1/2 ket(0_A) bra(0_A) + 1/2 ket(1_A) bra(1_A) = 1/2 mat(1, 0; 0, 1) $

これは、前述の#text(weight: "bold")[混合状態の例]と全く同じ形式です。

- #text(weight: "bold")[エンタングルメントと非対角要素:]
  系全体（A+B）は非対角要素を持つ純粋状態ですが、その一部分（Aのみ）を取り出すと、非対角要素がゼロの混合状態になります。これは、エンタングルメントによってAとBの間に存在する量子的な相関（コヒーレンス）が、A単独の状態を見たときには隠れてしまい、古典的な確率（ランダムさ）として現れることを示しています。

このように、密度行列と部分トレースは、エンタングルメントという非局所的な相関を持つ系の部分系が、どのように振る舞うかを正確に記述するための不可欠な数学的ツールです。

= よくある質問

=== Q1: 非対角要素がゼロでないのは、どのような場合ですか？

#text(weight: "bold")[A1:]
はい、その状態が複数の基底状態の#text(weight: "bold")[重ね合わせ状態]にある場合です。

一般的な2準位系の純粋状態を $ket(psi) = c_0 ket(0) + c_1 ket(1)$ と書くと、その密度行列の非対角要素は $rho_(0 1) = c_0 c_1^*$ および $rho_(1 0) = c_1 c_0^*$ となります。

これらの項がゼロでないためには、係数 $c_0$ と $c_1$ が両方ともゼロでない必要があります。これは、まさしく状態が $ket(0)$ と $ket(1)$ の重ね合わせであることを意味します。もし状態が重ね合わせでなければ（例：$ket(psi) = ket(0)$）、非対角要素はゼロになります。

=== Q2: $rho_(0 1)$ と $rho_(1 0)$ の違いは何ですか？

#text(weight: "bold")[A2:]
互いに#text(weight: "bold")[複素共役]の関係にあります。つまり、$rho_(1 0) = (rho_(0 1))^*$ です。

これは、密度行列が物理的に意味を持つために、必ず#text(weight: "bold")[エルミート行列]でなければならないという要請から来ています。エルミート行列の定義は $rho = rho^dagger$ であり、成分で書くと $rho_(m n) = (rho_(n m))^*$ となります。

物理的には、この関係は非対角要素が持つ#text(weight: "bold")[位相情報]に由来します。$rho_(0 1)$ と $rho_(1 0)$ の絶対値は等しいですが、その位相の符号は逆になります。この位相は、重ね合わせ状態を構成する $ket(0)$ と $ket(1)$ の間の相対的な位相差の情報を担っています。

= 具体例：3準位系

3準位系を例に、密度行列の要素を具体的に見てみましょう。
基底状態として、 $ket(0)$、 $ket(1)$、 $ket(2)$ とします。

=== 純粋状態の例

状態が $ket(psi) = 1/sqrt(6) (ket(0) + 2 ket(1) + ket(2))$ という重ね合わせ状態で与えられる純粋状態を考えます。
このときの密度行列は、
$ rho = ket(psi) bra(psi) = 1/6 (ket(0) + 2 ket(1) + ket(2)) (bra(0) + 2 bra(1) + bra(2)) $
$
  space = 1/6 (
    ket(0)bra(0) + 2 ket(0)bra(1) + ket(0)bra(2) +
    2 ket(1)bra(0) + 4 ket(1)bra(1) + 2 ket(1)bra(2) +
    ket(2)bra(0) + 2 ket(2)bra(1) + ket(2)bra(2)
  )
$
行列で表現すると、
$
  rho = 1/6 mat(
    1, 2, 1;
    2, 4, 2;
    1, 2, 1
  )
$
となります。

- #text(weight: "bold")[対角要素:]
  $rho_(0 0) = 1/6$、$rho_(1 1) = 4/6 = 2/3$、$rho_(2 2) = 1/6$ となり、各基底状態を測定する確率がそれぞれ異なることを示します。

- #text(weight: "bold")[非対角要素：]
  $rho_(0 1) = 2/6 = 1/3$、$rho_(0 2) = 1/6$、$rho_(1 2) = 2/6 = 1/3$ など、すべての非対角要素がゼロではありません。これは、3つの基底状態の間に量子的な重ね合わせ（コヒーレンス）が存在することを示しています。

=== 混合状態の例

確率 1/2 で状態 $ket(0)$、確率 1/4 で状態 $ket(1)$、確率 1/4 で状態 $ket(2)$ が存在する混合状態を考えます。
このときの密度行列は、
$ rho = 1/2 ket(0) bra(0) + 1/4 ket(1) bra(1) + 1/4 ket(2) bra(2) $
行列で表現すると、
$
  rho = mat(
    1/2, 0, 0;
    0, 1/4, 0;
    0, 0, 1/4
  )
$
となります。

- #text(weight: "bold")[対角要素:]
  $rho_(0 0) = 1/2$、$rho_(1 1) = 1/4$、$rho_(2 2) = 1/4$ となり、各基底状態を見出す確率はそれぞれ異なります。

- #text(weight: "bold")[非対角要素：]
  すべての非対角要素がゼロです。これは、各基底状態の間に位相の相関、つまりコヒーレンスが存在しないことを意味します。この系は、量子的な重ね合わせではなく、古典的な確率で状態が混ざっているだけです。

=== Q3: 3準位系の非対角要素はどのような意味があるのでしょうか？

#text(weight: "bold")[A3:]
基本的な意味は2準位系と同じで、対応する基底状態間の#text(weight: "bold")[コヒーレンス（量子的な重ね合わせ）]を表します。3準位系（基底状態 $ket(0)$, $ket(1)$, $ket(2)$）の場合、非対角要素は以下の組み合わせのコヒーレンスを示します。

- $rho_(0 1)$ と $rho_(1 0)$: 状態 $ket(0)$ と $ket(1)$ の間のコヒーレンス
- $rho_(0 2)$ と $rho_(2 0)$: 状態 $ket(0)$ と $ket(2)$ の間のコヒーレンス
- $rho_(1 2)$ と $rho_(2 1)$: 状態 $ket(1)$ と $ket(2)$ の間のコヒーレンス

これらの非対角要素がゼロでない場合、それは対応する2つの基底状態が量子的な重ね合わせの状態にあり、互いに位相の相関を持っていることを意味します。これは、量子干渉や、特定の外部場（レーザーなど）を印加した際の準位間の遷移（例えば、$ket(0)$ から $ket(2)$ への直接的な遷移や、中間準位 $ket(1)$ を介した遷移）といった現象において重要になります。
